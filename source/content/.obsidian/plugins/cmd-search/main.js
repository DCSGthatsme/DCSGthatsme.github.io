/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var h=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var S=Object.prototype.hasOwnProperty;var C=(r,a)=>{for(var e in a)h(r,e,{get:a[e],enumerable:!0})},y=(r,a,e,t)=>{if(a&&typeof a=="object"||typeof a=="function")for(let s of w(a))!S.call(r,s)&&s!==e&&h(r,s,{get:()=>a[s],enumerable:!(t=m(a,s))||t.enumerable});return r};var f=r=>y(h({},"__esModule",{value:!0}),r);var v={};C(v,{default:()=>l});module.exports=f(v);var n=require("obsidian"),l=class extends n.Plugin{constructor(){super(...arguments);this.registeredIds=[];this.splitLeaf=null}showError(e){new n.Notice(`CmdSearch: ${e}`,4e3)}async onload(){await this.loadSettings(),this.registerCommands(),this.addSettingTab(new g(this.app,this))}async loadSettings(){let e={links:u,openSplitView:!1,searchSelectedText:!1,historyOption:!1};this.settings=Object.assign({},e,await this.loadData()),this.settings.links||(this.settings.links=e.links)}registerCommands(){this.registeredIds.forEach(e=>{this.removeCommand(e)}),this.registeredIds=[],this.settings.links.forEach((e,t)=>{if(!this.validateUrl(e.url)){e.name.trim()&&this.showError(`"${e.name}" has an invalid URL format and did not register.`);return}let s=`${t}`;this.addCommand({id:s,name:`${e.name}`,callback:()=>{this.handleCommandCallback(e)}}),this.registeredIds.push(s)}),this.addCommand({id:"palette",name:"Open CmdSearch palette",callback:()=>{new p(this.app,this).open()}})}handleCommandCallback(e){let t=this.getSelectedText();e.url.includes("%s")||e.url.includes("${Q}")?this.settings.searchSelectedText&&t?(this.openLink(e.url,t),this.recordHistory(e,t)):new d(this.app,this,e).open():this.openLink(e.url,"")}async saveSettings(){await this.saveData(this.settings)}validateUrl(e){try{let t=e.replace("%s","test");return new URL(t),!0}catch(t){return!1}}openLink(e,t){var s;try{let i=e.includes("%s")?e.replace("%s",encodeURIComponent(t)):e.includes("${Q}")?e.replace("${Q}",encodeURIComponent(t)):e;this.settings.openSplitView&&(!this.splitLeaf||((s=this.splitLeaf)==null?void 0:s.getViewState().type)==="empty"?this.splitLeaf=this.app.workspace.getLeaf("split","vertical"):this.app.workspace.setActiveLeaf(this.splitLeaf)),window.open(i,"_blank")}catch(i){this.showError("Failed to open URL: "+i)}}getSelectedText(){let e=this.app.workspace.getActiveViewOfType(n.MarkdownView);return e&&e.editor?e.editor.getSelection():""}recordHistory(e,t){if(!this.settings.historyOption)return;let s=e.history||[],i=s.indexOf(t);i!==-1&&s.splice(i,1);let o=[t,...s];e.history=o.slice(0,7),this.saveSettings()}},d=class extends n.FuzzySuggestModal{constructor(e,t,s){super(e);this.plugin=t,this.selected=s,this.setPlaceholder("Enter search query...")}getItems(){return["",...this.selected.history?this.selected.history:[]]}getItemText(e){let t=this.inputEl.value;return e?this.inputEl.value===""?e:"":`Searching ${this.selected.name} for ${t}`}onChooseItem(e){if(e)this.plugin.openLink(this.selected.url,e),this.plugin.recordHistory(this.selected,e);else{let t=this.inputEl.value.trim();this.plugin.openLink(this.selected.url,t),t&&this.plugin.recordHistory(this.selected,t)}}},p=class extends n.FuzzySuggestModal{constructor(e,t){super(e);this.plugin=t,this.setPlaceholder("Search CmdSearch Links..."),this.cmdSearchCommands=this.plugin.settings.links}getItems(){return[...this.cmdSearchCommands,{name:"CmdSearch: Clear History",type:"cmd"}]}getItemText(e){return e.name}onChooseItem(e){e.url&&this.plugin.handleCommandCallback(e),e.type==="cmd"&&(this.plugin.settings.links.forEach(t=>{t.history=[]}),this.plugin.saveSettings(),new n.Notice("CmdSearch: History Cleared",4e3))}},u=[{name:"Google",url:"https://www.google.com/search?q=%s"},{name:"YouTube",url:"https://www.youtube.com/results?search_query=%s"},{name:"GoogleImages",url:"https://www.google.com/search?tbm=isch&q=%s"},{name:"Wikipedia",url:"https://en.wikipedia.org/wiki/%s"},{name:"OpenStreetMap",url:"https://www.openstreetmap.org/search?query=%s"},{name:"DuckDuckGo",url:"https://duckduckgo.com/?q=%s"}],g=class extends n.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t}display(){let{containerEl:e}=this;e.addClass("cmd-search-settings-container");let t=e.scrollTop;e.empty(),this.plugin.settings.links.forEach((s,i)=>{this.createLinkSetting(e,s,i)}),this.createAddNewCommandSetting(e),this.createCommandInformationSetting(e),this.openSplitViewSetting(e),this.searchSelectedText(e),this.historySetting(e),this.createSettingsFooter(e),e.scrollTop=t}createLinkSetting(e,t,s){let i=new n.Setting(e);i.settingEl.addClass("setting-container"),i.addText(o=>(o.inputEl.addClass("name-input"),o.setPlaceholder("Enter name").setValue(t.name).onChange(async c=>{this.plugin.settings.links[s].name=c,await this.plugin.saveSettings()}))),i.addText(o=>(o.inputEl.addClass("url-input"),o.setPlaceholder("Enter URL").setValue(t.url).onChange(async c=>{this.plugin.settings.links[s].url=c,await this.plugin.saveSettings()}))),i.addButton(o=>o.setButtonText("Remove").onClick(async()=>{this.plugin.settings.links.splice(s,1),await this.plugin.saveSettings(),this.display()}))}createAddNewCommandSetting(e){let t="Custom";new n.Setting(e).setName("Add new command").addDropdown(s=>{s.addOption("Custom","Custom"),u.forEach(i=>{s.addOption(i.name,i.name)}),s.onChange(i=>{t=i})}).addButton(s=>s.setButtonText("Add").onClick(async()=>{let i=t==="Custom"?{name:"",url:""}:u.find(o=>o.name===t);i&&(this.plugin.settings.links.push({...i}),await this.plugin.saveSettings(),this.display())}))}createCommandInformationSetting(e){let t=document.createDocumentFragment();t.append("The name you set is what appears in the command palette. ",t.createEl("br"),"For URLs:",t.createEl("br"),"- Use %s as a placeholder for your search query.",t.createEl("br"),"- Don't include %s if you want the URL to open without a prompt. (some sites don't support search urls)",t.createEl("br"),"- To better align with web standards, the default option has been changed to %s. ${Q} is still a valid alternative.",t.createEl("br"),t.createEl("br"),"Bind 'Open CmdSearch Palette' to a hotkey for instant access to your CmdSearch links"),new n.Setting(e).setName("Command information").setDesc(t).addButton(s=>{let i="Copy %s";return s.setButtonText(i).onClick(async()=>{await navigator.clipboard.writeText("%s"),s.setButtonText("Copied!"),setTimeout(()=>{s.setButtonText(i)},1500)}),s})}openSplitViewSetting(e){new n.Setting(e).setName("Open links to the right").setDesc("Links open in a split view beside the current window. Subsequent links will group.").addToggle(t=>(t.setValue(this.plugin.settings.openSplitView),t.onChange(async s=>{this.plugin.settings.openSplitView=s,await this.plugin.saveSettings()}),t))}searchSelectedText(e){new n.Setting(e).setName("Search selected text").setDesc("If you have text selected when executing a search command, it will use that selection as the search query.").addToggle(t=>(t.setValue(this.plugin.settings.searchSelectedText),t.onChange(async s=>{this.plugin.settings.searchSelectedText=s,await this.plugin.saveSettings()}),t))}historySetting(e){new n.Setting(e).setName("History").setDesc("Shows up to seven of your most recent queries for that command. Clear History is in the CmdSearch palette.").addToggle(t=>(t.setValue(this.plugin.settings.historyOption),t.onChange(async s=>{this.plugin.settings.historyOption=s,await this.plugin.saveSettings()}),t))}createSettingsFooter(e){new n.Setting(e);let t=e.createDiv();t.addClass("settings-footer"),t.createEl("a",{href:"https://github.com/SpaceshipCaptain/CmdSearch"},s=>{s.innerHTML='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m 10,0 c 5.523,0 10,4.59 10,10.253 0,4.529 -2.862,8.371 -6.833,9.728 -0.507,0.101 -0.687,-0.219 -0.687,-0.492 0,-0.338 0.012,-1.442 0.012,-2.814 0,-0.956 -0.32,-1.58 -0.679,-1.898 2.227,-0.254 4.567,-1.121 4.567,-5.059 0,-1.12 -0.388,-2.034 -1.03,-2.752 0.104,-0.259 0.447,-1.302 -0.098,-2.714 0,0 -0.838,-0.275 -2.747,1.051 C 11.706,5.076 10.85,4.962 10,4.958 9.15,4.958 8.295,5.076 7.497,5.303 5.586,3.977 4.746,4.252 4.746,4.252 4.203,5.664 4.546,6.707 4.649,6.966 4.01,7.684 3.619,8.598 3.619,9.718 c 0,3.928 2.335,4.808 4.556,5.067 -0.286,0.256 -0.545,0.708 -0.635,1.371 -0.57,0.262 -2.018,0.715 -2.91,-0.852 0,0 -0.529,-0.985 -1.533,-1.057 0,0 -0.975,-0.013 -0.068,0.623 0,0 0.655,0.315 1.11,1.5 0,0 0.587,1.83 3.369,1.21 0.005,0.857 0.014,1.665 0.014,1.909 0,0.271 -0.184,0.588 -0.683,0.493 C 2.865,18.627 0,14.783 0,10.253 0,4.59 4.478,0 10,0"/></svg>Issues'}),t.createEl("a",{href:"https://www.paypal.com/donate?hosted_button_id=44CMB9VHXFG68"},s=>{s.innerHTML='<svg viewBox="-1.5 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M 16.47546,5.9 C 15.2608,11.117 11.55564,12 6.57866,12 L 5.07814,20 H 7.82541 C 8.32592,20 8.53555,19.659 8.62783,19.179 9.31289,14.848 9.2166,15.557 9.27879,14.879 9.33799,14.501 9.66495,14 10.04911,14 13.6981,14 16.11839,12.945 16.85761,9.158 17.1204,7.811 17.03414,6.772 16.47546,5.9 M 5.13431,11.86 4.01193,18 H 0.53546 c -0.329,0 -0.58075,-0.402 -0.5286,-0.726 L 2.60268,0.751 C 2.67088,0.319 3.04501,0 3.48434,0 h 6.23377 c 3.69112,0 6.1766,1.401 5.60187,5.054 C 14.31395,11.56 8.73716,11 6.19951,11 c -0.43932,0 -0.996,0.428 -1.0652,0.86"/></svg>Donations'})}async hide(){await this.plugin.saveSettings(),this.plugin.registerCommands(),super.hide()}};

/* nosourcemap */